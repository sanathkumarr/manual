AWS VPC SETUP: PUBLIC & PRIVATE SUBNETS WITH NAT GATEWAY
=========================================================

ğŸ“˜ STEP 1: CREATE A VPC
-----------------------
Go to AWS Console â†’ VPC â†’ Your VPCs â†’ Create VPC.
- Name tag: MyVPC
- IPv4 CIDR block: 10.0.0.0/16
- Leave other settings as default
â¡ï¸ Click "Create VPC"

ğŸŒ STEP 2: CREATE SUBNETS
-------------------------
Go to VPC â†’ Subnets â†’ Create Subnet

ğŸ”¹ Public Subnet
- Name: PublicSubnet
- VPC: MyVPC
- Availability Zone: us-east-1a
- CIDR block: 10.0.1.0/24
â¡ï¸ Click "Create subnet"

ğŸ”¹ Private Subnet
- Name: PrivateSubnet
- VPC: MyVPC
- Availability Zone: us-east-1b
- CIDR block: 10.0.2.0/24
â¡ï¸ Click "Create subnet"

ğŸŒ STEP 3: CREATE AN INTERNET GATEWAY (IGW)
------------------------------------------
Go to VPC â†’ Internet Gateways â†’ Create Internet Gateway
- Name: MyIGW
â¡ï¸ Attach to VPC â†’ Select MyVPC

ğŸ” STEP 4: CONFIGURE ROUTE TABLES
---------------------------------
ğŸ”¹ Public Route Table
- VPC â†’ Route Tables â†’ Create Route Table
- Name: PublicRouteTable
- VPC: MyVPC
- Go to Routes â†’ Edit routes â†’ Add:
  - Destination: 0.0.0.0/0
  - Target: Internet Gateway â†’ MyIGW
- Go to Subnet Associations â†’ Associate with PublicSubnet

ğŸ“¡ STEP 5: ENABLE AUTO PUBLIC IP FOR PUBLIC SUBNET
--------------------------------------------------
- Go to Subnets â†’ PublicSubnet â†’ Actions â†’ Edit subnet settings
- Enable: âœ… Auto-assign public IPv4 address
â¡ï¸ Click Save

ğŸ” STEP 6: CREATE EC2 INSTANCES & SECURITY GROUPS
-------------------------------------------------
ğŸ”¹ Public EC2 Instance:
- Name: public
- Key pair: sanath.pem
- Network: MyVPC
- Subnet: PublicSubnet
- Auto-assign Public IP: ENABLED
- Security Group: vpc-pub
- Inbound: SSH (22), HTTP (80) â†’ Source: Your IP
- Launch

ğŸ”¹ Private EC2 Instance:
- Name: private
- Key pair: sanath.pem
- Network: MyVPC
- Subnet: PrivateSubnet
- Auto-assign Public IP: DISABLED
- Security Group: vpc-prv
- Inbound: SSH (22) from 10.0.1.0/24 or vpc-pub SG
- Launch

ğŸŒ STEP 7: CREATE A NAT GATEWAY
------------------------------
ğŸ”¹ Allocate Elastic IP:
- Go to EC2 â†’ Elastic IPs â†’ Allocate

ğŸ”¹ Create NAT Gateway:
- VPC â†’ NAT Gateways â†’ Create NAT Gateway
- Subnet: PublicSubnet
- Elastic IP: Use allocated one
- Name: MyNATGateway
â¡ï¸ Wait until available

ğŸ”„ STEP 8: CONFIGURE PRIVATE ROUTE TABLE
----------------------------------------
- Create Route Table â†’ Name: PrivateRouteTable â†’ VPC: MyVPC
- Routes â†’ Edit:
  - Destination: 0.0.0.0/0
  - Target: NAT Gateway â†’ MyNATGateway
- Subnet Associations â†’ Associate with PrivateSubnet

ğŸ“¥ STEP 9: SETUP WEB SERVER ON PUBLIC INSTANCE
----------------------------------------------
SSH into Public Instance:

sudo su -
yum install httpd -y
systemctl enable httpd
systemctl start httpd
cd /var/www/html
vim index.html  # Add HTML content

- Go to Security Group â†’ Edit Inbound â†’ Add HTTP (port 80)
- Copy public IP â†’ Open in browser â†’ See index.html page

ğŸ”’ STEP 10: CONNECT TO PRIVATE INSTANCE VIA PUBLIC BASTION
-----------------------------------------------------------
On your local machine:

vim sanath.pem  # Paste private key content
chmod 400 sanath.pem
ssh -i sanath.pem ec2-user@<Public-Instance-IP>

Then from Public instance SSH into Private:

ssh ec2-user@<Private-Instance-IP>
sudo su -
ping google.com  # Should work due to NAT gateway


âœ… COMPLETE: Private instance has internet via NAT Gateway, public instance serves web content.
=========================================================